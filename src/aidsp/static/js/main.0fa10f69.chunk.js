(this["webpackJsonpauk47p.run"]=this["webpackJsonpauk47p.run"]||[]).push([[0],{249:function(e,t,a){e.exports=a(250)},250:function(e,t,a){"use strict";a.r(t);var n=a(45),r=a(96),i=a(72),o=a(73),l=a(76),c=a(74),s=a(77),u=a(0),d=a.n(u),m=a(10),h=a.n(m),p=(a(255),a(256),a(55)),f=a(62),g=a(243),_=a(95),y=a(47),w=a(543),E=a(180),k=a(24),v=a(8),b=a(78),S=a(22),j=a(49),x=a(34),C=a(545),O=a(41),I=a(245),D=a(246),T=a(181),P=a(542),M=a(108),Y=a(42),q=a(544),z=a(71),L=a(174),F=a.n(L),V=a(63),A=a.n(V),K=a(15),R=a.n(K),B=a(94),H=a.n(B),N=a(244),W=(a(260),a(75)),G=a.n(W),J=(a(290),a(43)),X=p.a.SubMenu,Q=f.a.Option,U=g.a.confirm,Z=_.a.TabPane,$=y.a.Panel,ee=w.a.Text,te=E.a.TextArea,ae=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).getColumnSearchProps=function(e){return{filterDropdown:function(t){var n=t.setSelectedKeys,r=t.selectedKeys,i=t.confirm,o=t.clearFilters;return d.a.createElement("div",{style:{padding:8}},d.a.createElement(E.a,{ref:function(e){a.searchInput=e},placeholder:"Search ".concat(e),value:r[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return a.handleSearch(r,i,e)},style:{width:188,marginBottom:8,display:"block"}}),d.a.createElement(k.a,{type:"primary",onClick:function(){return a.handleSearch(r,i,e)},icon:"search",size:"small",style:{width:90,marginRight:8}},"Search"),d.a.createElement(k.a,{onClick:function(){return a.handleReset(o)},size:"small",style:{width:90}},"Reset"))},filterIcon:function(e){return d.a.createElement(v.a,{type:"search",style:{color:e?"#1890ff":void 0}})},onFilter:function(t,a){return a[e].toString().toLowerCase().includes(t.toLowerCase())},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return a.searchInput.select()}))},render:function(t){return a.state.searchedColumn===e?d.a.createElement(F.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[a.state.searchText],autoEscape:!0,textToHighlight:t.toString()}):t}}},a.columns_proj=[Object(r.a)({title:"",dataIndex:"project_id"},a.getColumnSearchProps("project_id"),{render:function(e,t){return d.a.createElement("p",null)},width:20}),Object(r.a)({title:"\u9879\u76ee\u540d",dataIndex:"project_name",sorter:function(e,t){return e.project_name.charCodeAt()-t.project_name.charCodeAt()}},a.getColumnSearchProps("project_name"),{render:function(e,t){return d.a.createElement("a",{onClick:a.showModal,href:"display/"+t.id},t.project_id+"_"+e)}}),{title:"\u72b6\u6001",dataIndex:"status",filters:[{text:"\u672a\u5f00\u59cb",value:"\u672a\u5f00\u59cb"},{text:"\u51c6\u5907\u4e2d",value:"\u51c6\u5907\u4e2d"},{text:"\u6570\u636e\u91c7\u96c6",value:"\u6570\u636e\u91c7\u96c6"},{text:"\u6570\u636e\u6807\u6ce8",value:"\u6570\u636e\u6807\u6ce8"},{text:"\u6682\u505c",value:"\u6682\u505c"},{text:"\u5b8c\u7ed3",value:"\u5b8c\u7ed3"}],onFilter:function(e,t){return 0==t.status.indexOf(e)}},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"create_time",sorter:function(e,t){return new Date(e.create_time)-new Date(t.create_time)},render:function(e,t){return t.create_time?new Date(t.create_time).toLocaleString():""}},{title:"\u5269\u4f59\u65f6\u95f4",dataIndex:"remaining_time",sorter:function(e,t){return("\u5df2\u7ed3\u675f"!=e.remaining_time?e.remaining_time.split("\u5929")[0]:9999)-("\u5df2\u7ed3\u675f"!=t.remaining_time?t.remaining_time.split("\u5929")[0]:9999)}},{title:"\u6807\u7b7e",dataIndex:"labels",sorter:function(e,t){return e.labels.length-t.labels.length},render:function(e){return d.a.createElement("span",null,e.map((function(e){return d.a.createElement(b.a,{color:"blue",key:e},e)})))}},{title:"\u521b\u5efa\u4eba",dataIndex:"users_found",render:function(e){return d.a.createElement("span",null,e.map((function(e){return d.a.createElement(b.a,{color:"blue",key:e},e)})))}},{title:"\u7ba1\u7406\u4eba",dataIndex:"users_manager",render:function(e){return d.a.createElement("span",null,e.map((function(e){return d.a.createElement(b.a,{color:"blue",key:e},e)})))}},{title:"\u53c2\u4e0e\u4eba",width:220,dataIndex:"users_attend",render:function(e){return d.a.createElement("span",null,e.map((function(e){return d.a.createElement(b.a,{color:"blue",key:e},e)})))}},{title:"\u672c\u5468\u5de5\u4f5c\u91cf",dataIndex:"quantity_week",sorter:function(e,t){return(e.quantity_week?e.quantity_week.length:0)-(t.quantity_week?t.quantity_week.length:0)},ellipsis:!0},{title:"\u4efb\u52a1\u63cf\u8ff0",dataIndex:"task_description",sorter:function(e,t){return(e.task_description?e.task_description.length:0)-(t.task_description?t.task_description.length:0)},ellipsis:!0},{title:"\u9884\u8ba1\u5b8c\u6210\u65f6\u95f4",dataIndex:"expected_time",sorter:function(e,t){return new Date(e.expected_time)-new Date(t.expected_time)},render:function(e,t){return t.expected_time?new Date(t.expected_time).toLocaleString():""}}],a.columns_pers=[Object(r.a)({title:"",dataIndex:"project_id"},a.getColumnSearchProps("project_id"),{render:function(e,t){return d.a.createElement("p",null)},width:1}),Object(r.a)({title:"\u9879\u76ee\u540d",dataIndex:"project_name",sorter:function(e,t){return("\u7a7a\u95f2"!=e.project_name?e.project_name.charCodeAt():"k")-("\u7a7a\u95f2"!=t.project_name?t.project_name.charCodeAt():"k")}},a.getColumnSearchProps("project_name"),{render:function(e,t){return"\u7a7a\u95f2"!=t.project_name?d.a.createElement("a",{onClick:a.showModal,href:"display/"+t.id},t.project_id+"_"+e):d.a.createElement("a",null,"\u7a7a\u95f2")}}),{title:"\u72b6\u6001",dataIndex:"status",filters:[{text:"\u672a\u5f00\u59cb",value:"\u672a\u5f00\u59cb"},{text:"\u51c6\u5907\u4e2d",value:"\u51c6\u5907\u4e2d"},{text:"\u6570\u636e\u91c7\u96c6",value:"\u6570\u636e\u91c7\u96c6"},{text:"\u6570\u636e\u6807\u6ce8",value:"\u6570\u636e\u6807\u6ce8"},{text:"\u6682\u505c",value:"\u6682\u505c"},{text:"\u5b8c\u7ed3",value:"\u5b8c\u7ed3"}],onFilter:function(e,t){return-1!=t.status.indexOf(e)},render:function(e,t){return"\u7a7a\u95f2"!=t.project_name?e:""}},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"create_time",sorter:function(e,t){return new Date(e.create_time)-new Date(t.create_time)},render:function(e,t){return t.create_time?new Date(t.create_time).toLocaleString():""}},{title:"\u5269\u4f59\u65f6\u95f4",dataIndex:"remaining_time",sorter:function(e,t){return(e.remaining_time?"\u5df2\u7ed3\u675f"!=e.remaining_time?e.remaining_time.split("\u5929")[0]:9999:"k")-(t.remaining_time?"\u5df2\u7ed3\u675f"!=t.remaining_time?t.remaining_time.split("\u5929")[0]:9999:"k")}},{title:"\u6b63\u5728\u8fdb\u884c\u4eba\u5458",dataIndex:"now_person",render:function(e){return d.a.createElement("span",null,e.map((function(e){return d.a.createElement(b.a,{color:"blue",key:e},e)})))},sorter:function(e,t){return(e.now_person?e.now_person.length:0)-(t.now_person?t.now_person.length:0)}}],a.state={loading:!1,visible:!1,searchText:"",searchedColumn:"",data:[],sta:"proj"},a.handleSearch=function(e,t,n){t(),a.setState({searchText:e[0],searchedColumn:n})},a.handleReset=function(e){e(),a.setState({searchText:""})},a.fetch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("params:",e),a.setState({loading:!0}),A()({url:window.location.protocol+"//"+window.location.host+"/aidsp/api/project/?format=json",method:"get"}).then((function(e){a.setState({data:e}),a.setState({loading:!1})}))},a.staChange=function(e){a.setState({sta:e.target.value})},a.rm_workload=function(e){U({title:"\u786e\u5b9a",icon:d.a.createElement(N.a,null),content:"\u60a8\u786e\u5b9a\u8981\u6e05\u7a7a\u672c\u5468\u5de5\u4f5c\u91cf\uff1f",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){S.a.loading({content:"\u63d0\u4ea4\u4e2d\u3002\u3002\u3002",key:"rm_workload",duration:null}),A()({url:"/aidsp/workloadrm",method:"get"}).then((function(e){"\u6e05\u7a7a\u5b8c\u6bd5\uff01"==e?(S.a.success({content:"\u6e05\u7a7a\u5b8c\u6bd5!",key:"rm_workload"}),a.fetch()):S.a.info({content:e,key:"rm_workload"})}))},onCancel:function(){console.log("Cancel")}})},a}return Object(s.a)(t,e),Object(o.a)(t,[{key:"showModal",value:function(){}},{key:"componentDidMount",value:function(){this.fetch()}},{key:"render",value:function(){var e=this.state.sta;return d.a.createElement("div",null,d.a.createElement(k.a,{href:"newproject",type:"primary",style:{float:"left",marginRight:"20px"}},"\u65b0\u5efa\u9879\u76ee"),d.a.createElement(j.a.Group,{value:e,onChange:this.staChange},d.a.createElement(j.a.Button,{value:"proj"},"\u9879\u76ee\u8be6\u60c5"),d.a.createElement(j.a.Button,{value:"pers"},"\u4eba\u5458\u72b6\u6001")),d.a.createElement(k.a,{style:{marginLeft:"20px"},onClick:this.rm_workload},"\u6e05\u7a7a\u672c\u5468\u5de5\u4f5c\u91cf"),d.a.createElement("br",null),d.a.createElement("br",null),"proj"==this.state.sta?d.a.createElement(x.a,{style:{width:2e3,overflowX:"auto"},columns:this.columns_proj,dataSource:this.state.data.filter((function(e){return"\u7a7a\u95f2"!=e.project_name})),rowKey:function(e){return e.id},loading:this.state.loading}):d.a.createElement(x.a,{columns:this.columns_pers,dataSource:this.state.data,rowKey:function(e){return e.id},loading:this.state.loading}))}}]),t}(d.a.Component),ne=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={loading:!1,visible:!1,searchText:"",searchedColumn:"",data:[]},a.getColumnSearchProps=function(e){return{filterDropdown:function(t){var n=t.setSelectedKeys,r=t.selectedKeys,i=t.confirm,o=t.clearFilters;return d.a.createElement("div",{style:{padding:8}},d.a.createElement(E.a,{ref:function(e){a.searchInput=e},placeholder:"Search ".concat(e),value:r[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return a.handleSearch(r,i,e)},style:{width:188,marginBottom:8,display:"block"}}),d.a.createElement(k.a,{type:"primary",onClick:function(){return a.handleSearch(r,i,e)},icon:"search",size:"small",style:{width:90,marginRight:8}},"Search"),d.a.createElement(k.a,{onClick:function(){return a.handleReset(o)},size:"small",style:{width:90}},"Reset"))},filterIcon:function(e){return d.a.createElement(v.a,{type:"search",style:{color:e?"#1890ff":void 0}})},onFilter:function(t,a){return a[e].toString().toLowerCase().includes(t.toLowerCase())},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return a.searchInput.select()}))},render:function(t){return a.state.searchedColumn===e?d.a.createElement(F.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[a.state.searchText],autoEscape:!0,textToHighlight:t.toString()}):t}}},a.handleSearch=function(e,t,n){t(),a.setState({searchText:e[0],searchedColumn:n})},a.handleReset=function(e){e(),a.setState({searchText:""})},a.columns=[Object(r.a)({},a.getColumnSearchProps("name"),{render:function(e,t){return d.a.createElement("a",{href:"dataset_display/"+t.id},t.name)},title:"\u6570\u636e\u96c6\u540d\u79f0",dataIndex:"name",sorter:function(e,t){return e.name.charCodeAt()-t.name.charCodeAt()}}),{title:"\u6240\u5c5e\u9879\u76ee",dataIndex:"project"},{title:"\u6570\u636e\u96c6\u63cf\u8ff0",dataIndex:"describe",ellipsis:!0},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",sorter:function(e,t){return new Date(e.create_time)-new Date(t.create_time)},render:function(e,t){return new Date(t.create_time).toLocaleString()}},{title:"\u66f4\u65b0\u65f6\u95f4",dataIndex:"update_time",sorter:function(e,t){return new Date(e.update_time)-new Date(t.update_time)},render:function(e,t){return new Date(t.update_time).toLocaleString()}},{title:"\u6570\u91cf\u8be6\u60c5",dataIndex:"quantity_detials"}],a.fetch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("params:",e),a.setState({loading:!0}),A()({url:window.location.protocol+"//"+window.location.host+"/aidsp/api/dataset/?format=json",method:"get"}).then((function(e){a.setState({data:e}),a.setState({loading:!1})}))},a}return Object(s.a)(t,e),Object(o.a)(t,[{key:"showModal",value:function(){}},{key:"componentDidMount",value:function(){this.fetch()}},{key:"render",value:function(){return d.a.createElement("div",null,d.a.createElement(k.a,{href:"newdataset",type:"primary"},"\u65b0\u5efa\u6570\u636e\u96c6"),d.a.createElement("br",null),d.a.createElement("br",null),d.a.createElement(x.a,{columns:this.columns,dataSource:this.state.data,rowKey:function(e){return e.id},loading:this.state.loading}))}}]),t}(d.a.Component),re=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={data:{}},a.fetch=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];A()({url:window.location.protocol+"//"+window.location.host+"/aidsp/api/user/?format=json",method:"get"}).then((function(e){a.setState({user_data:e});var t=e.map((function(e){return d.a.createElement(Q,{value:e.id},e.name)}));a.setState({Options:t})})),A()({url:window.location.protocol+"//"+window.location.host+"/aidsp/project/personal_tasks/",method:"get"}).then((function(e){a.setState({data:e})}))},a.columns=[{title:"\u4efb\u52a1\u540d\u79f0",dataIndex:"task_name"},{title:"\u4efb\u52a1\u94fe\u63a5",dataIndex:"task_link",render:function(e,t){return d.a.createElement("div",null,Object.entries(t.task_link.split(" ")).map((function(e,t){return d.a.createElement("a",{href:e[1],target:"_blank"},e[1],d.a.createElement("br",null))})))}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",sorter:function(e,t){return new Date(e.create_time)-new Date(t.create_time)},render:function(e,t){return new Date(t.create_time).toLocaleString()}},{title:"\u5f00\u59cb\u65f6\u95f4",dataIndex:"begin_time",sorter:function(e,t){return new Date(e.begin_time)-new Date(t.begin_time)},render:function(e,t){return t.begin_time?new Date(t.begin_time).toLocaleString():""}},{title:"\u5b8c\u6210\u65f6\u95f4",dataIndex:"done_time",sorter:function(e,t){return new Date(e.done_time)-new Date(t.done_time)},render:function(e,t){return t.done_time?new Date(t.done_time).toLocaleString():""}},{title:"\u91cd\u542f\u65f6\u95f4",dataIndex:"time_label",sorter:function(e,t){return new Date(e.time_label)-new Date(t.time_label)},render:function(e,t){return t.time_label?new Date(t.time_label).toLocaleString():""}},{title:"\u4efb\u52a1\u7528\u65f6",dataIndex:"used_time"},{title:"\u4efb\u52a1\u5386\u65f6",dataIndex:"total_time"},{title:"\u5de5\u4f5c\u603b\u91cf",dataIndex:"gross"},{title:"\u6709\u6548\u5de5\u4f5c\u91cf",dataIndex:"quantity_available",render:function(e,t){return t.is_admin&&"\u901a\u8fc7"==t.status?d.a.createElement(C.a,{value:t.quantity_available,onBlur:a.quantity_available_change(t.id)}):t.quantity_available}},{title:"\u72b6\u6001",dataIndex:"status"},{title:"\u672a\u901a\u8fc7\u7406\u7531",width:500,dataIndex:"error_info",render:function(e,t){return t.is_admin?d.a.createElement(te,{placeholder:"",autoSize:!0,defaultValue:t.error_info,onBlur:a.error_info_change(t.id)}):t.error_info}},{title:"\u5ba1\u6838\u6b21\u6570",dataIndex:"number_of_reviews",sorter:function(e,t){return e.number_of_reviews-t.number_of_reviews}},{title:"\u6807\u6ce8\u5458",dataIndex:"assignee",render:function(e,t){return d.a.createElement("span",null,d.a.createElement(f.a,{mode:"multiple",optionFilterProp:"children",style:{width:"100%"},value:t.assignee,disabled:!0,onChange:a.assignee_change(t.id,t.is_admin)},a.state.Options),",")}},{title:"\u5ba1\u6838\u5458",dataIndex:"reviewer",render:function(e,t){return d.a.createElement("span",null,d.a.createElement(f.a,{mode:"multiple",optionFilterProp:"children",style:{width:"100%"},value:t.reviewer,disabled:!0,onChange:a.reviewer_change(t.id,t.is_admin)},a.state.Options),",")}},{title:"\u64cd\u4f5c",dataIndex:"",render:function(e,t){return d.a.createElement("div",null,t.is_admin||"\u672a\u5f00\u59cb"!=t.status&&"\u6682\u505c"!=t.status?"":d.a.createElement(O.a,{title:"\u5f00\u59cb"},d.a.createElement(v.a,{type:"play-circle",theme:"twoTone",onClick:a.taskStatusChange(t.id,1),style:{marginRight:"5px"}})),t.is_admin||"\u6b63\u5728\u8fdb\u884c"!=t.status?"":d.a.createElement(O.a,{title:"\u6682\u505c"},d.a.createElement(v.a,{type:"pause-circle",theme:"twoTone",onClick:a.taskStatusChange(t.id,5),style:{marginRight:"5px"}})),t.is_admin||"\u6b63\u5728\u8fdb\u884c"!=t.status&&"\u672a\u901a\u8fc7"!=t.status?"":d.a.createElement(O.a,{title:"\u63d0\u4ea4\u5ba1\u6838"},d.a.createElement(v.a,{type:"plus-circle",theme:"twoTone",onClick:a.taskStatusChange(t.id,2),style:{marginRight:"5px"}})),t.is_admin&&"\u5f85\u5ba1\u6838"==t.status?d.a.createElement(O.a,{title:"\u901a\u8fc7"},d.a.createElement(v.a,{type:"check-circle",theme:"twoTone",onClick:a.taskStatusChange(t.id,3),style:{marginRight:"5px"}})):"",t.is_admin&&"\u5f85\u5ba1\u6838"==t.status?d.a.createElement(O.a,{title:"\u4e0d\u901a\u8fc7"},d.a.createElement(v.a,{type:"close-circle",theme:"twoTone",onClick:a.taskStatusChange(t.id,4),style:{marginRight:"5px"}})):"")}}],a.reviewer_done_count=function(e){var t=0;if(a.state.data.reviewer){for(var n in a.state.data.reviewer[2])t+=a.state.data.reviewer[2][n].length;return t}return t},a.assignee_not_pass_count=function(e){var t=0;if(a.state.data.assignee){for(var n in a.state.data.assignee[4])t+=a.state.data.assignee[4][n].length;return t}return t},a}return Object(s.a)(t,e),Object(o.a)(t,[{key:"assignee_change",value:function(e,t){var a=this;return function(n){t&&(S.a.loading({content:"\u63d0\u4ea4\u4e2d\u3002\u3002\u3002",key:"assignee_change"}),fetch(window.location.protocol+"//"+window.location.host+"/aidsp/project/tasks_change/"+e+"/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:H.a.stringify({assignee:n?n.toString():[],id:e})}).then((function(e){201==e.status||200==e.status?(a.fetch(),S.a.success({content:"\u63d0\u4ea4\u6210\u529f!",key:"assignee_change"})):S.a.error({content:"\u9519\u8bef"+e.status+" \u63d0\u4ea4\u5931\u8d25",key:"assignee_change"})})))}}},{key:"reviewer_change",value:function(e,t){var a=this;return function(n){t&&(S.a.loading({content:"\u63d0\u4ea4\u4e2d\u3002\u3002\u3002",key:"reviewer_change"}),fetch(window.location.protocol+"//"+window.location.host+"/aidsp/project/tasks_change/"+e+"/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:H.a.stringify({reviewer:n?n.toString():[],id:e})}).then((function(e){201==e.status||200==e.status?(a.fetch(),S.a.success({content:"\u63d0\u4ea4\u6210\u529f!",key:"reviewer_change"})):S.a.error({content:"\u9519\u8bef"+e.status+" \u63d0\u4ea4\u5931\u8d25",key:"reviewer_change"})})))}}},{key:"taskStatusChange",value:function(e,t){var a=this;return function(n){var r;switch(t){case 1:r="\u5f00\u59cb";break;case 5:r="\u6682\u505c";break;case 2:r="\u63d0\u4ea4\u5ba1\u6838";break;case 3:r="\u901a\u8fc7";break;case 4:r="\u4e0d\u901a\u8fc7";break;default:r="\u672a\u77e5"}U({title:r,icon:d.a.createElement(N.a,null),content:"\u60a8\u786e\u5b9a\u8981"+r+"\u8fd9\u4e2a\u4efb\u52a1\uff1f",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){S.a.loading({content:"\u63d0\u4ea4\u4e2d\u3002\u3002\u3002",key:"taskStatusChange"}),fetch(window.location.protocol+"//"+window.location.host+"/aidsp/project/tasks_change/"+e+"/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:H.a.stringify({id:e,status:t})}).then((function(e){200==e.status?(a.fetch(),S.a.success({content:"\u63d0\u4ea4\u6210\u529f!",key:"taskStatusChange"})):S.a.error({content:"\u9519\u8bef"+e.status+" \u63d0\u4ea4\u5931\u8d25",key:"taskStatusChange"})}))},onCancel:function(){console.log("Cancel")}})}}},{key:"quantity_available_change",value:function(e){var t=this;return function(a){var n=a.target.value;n&&(S.a.loading({content:"\u63d0\u4ea4\u4e2d\u3002\u3002\u3002",key:"quantity_available"}),fetch("/aidsp/project/tasks_change/"+e+"/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:H.a.stringify({id:e,quantity_available:n})}).then((function(e){201==e.status||200==e.status?(t.fetch(),S.a.success({content:"\u63d0\u4ea4\u6210\u529f!",key:"quantity_available"})):S.a.error("\u9519\u8bef"+e.status)})))}}},{key:"error_info_change",value:function(e){var t=this;return function(a){var n=a.target.value;n&&(S.a.loading({content:"\u63d0\u4ea4\u4e2d\u3002\u3002\u3002",key:"error_info_change"}),fetch("/aidsp/project/tasks_change/"+e+"/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:H.a.stringify({id:e,error_info:n})}).then((function(e){201==e.status||200==e.status?(t.fetch(),S.a.success({content:"\u63d0\u4ea4\u6210\u529f!",key:"error_info_change"})):S.a.error("\u9519\u8bef"+e.status)})))}}},{key:"componentDidMount",value:function(){this.fetch()}},{key:"render",value:function(){var e=this;return d.a.createElement("div",null,d.a.createElement(I.a,{title:"\u5ba1\u6838\u4efb\u52a1",style:{width:"100%"}},d.a.createElement(_.a,{defaultActiveKey:"1"},d.a.createElement(Z,{tab:"\u672a\u5f00\u59cb",key:"0"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.reviewer[0]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))),d.a.createElement(Z,{tab:"\u6b63\u5728\u8fdb\u884c",key:"1"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.reviewer[1]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))),d.a.createElement(Z,{tab:d.a.createElement(D.a,{count:this.reviewer_done_count()},d.a.createElement("span",null,"\u5f85\u5ba1\u6838")),key:"2"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.reviewer[2]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))),d.a.createElement(Z,{tab:"\u672a\u901a\u8fc7",key:"4"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.reviewer[4]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))),d.a.createElement(Z,{tab:"\u901a\u8fc7",key:"3"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.reviewer[3]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))))),d.a.createElement("br",null),d.a.createElement(I.a,{title:"\u6807\u6ce8\u4efb\u52a1",style:{width:"100%"}},d.a.createElement(_.a,{defaultActiveKey:"1"},d.a.createElement(Z,{tab:"\u672a\u5f00\u59cb",key:"0"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.assignee[0]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))),d.a.createElement(Z,{tab:"\u6b63\u5728\u8fdb\u884c",key:"1"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.assignee[1]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))),d.a.createElement(Z,{tab:"\u5f85\u5ba1\u6838",key:"2"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.assignee[2]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))),d.a.createElement(Z,{tab:d.a.createElement(D.a,{count:this.assignee_not_pass_count()},d.a.createElement("span",null,"\u672a\u901a\u8fc7")),key:"4"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.assignee[4]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))),d.a.createElement(Z,{tab:"\u901a\u8fc7",key:"3"},d.a.createElement(y.a,null,Object.entries(this.state.data.reviewer?this.state.data.assignee[3]:{}).map((function(t,a){return d.a.createElement($,{header:t[0],key:a},d.a.createElement(x.a,{columns:e.columns,dataSource:t[1]}))})))))))}}]),t}(d.a.Component),ie=(d.a.Component,function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={dataPickervalue:R()(),data:[],chartVisible:!1,hoursShow:!0,person_data:{},picorpoi:"pic"},a.dataPickerChange=function(e){var t=[e.format("YYYY"),e.format("MM"),e.format("DD")];a.data_fetch(t),a.setState({dataPickervalue:e})},a.data_fetch=function(e){var t=Object(n.a)(a),r=new FormData;r.append("YY",e[0]),r.append("MM",e[1]),r.append("DD",e[2]),G.a.post("/aidsp/workload/dailyinfo/",r).then((function(e){var a=e.data;t.setState({data:a})})).catch((function(e){console.log(e)}))},a.updated_time_fetch=function(e){var t=Object(n.a)(a);G.a.get("/aidsp/workload/getupdatedtime").then((function(e){var a=e.data;t.setState({updated_time:a.updated_time})})).catch((function(e){console.log(e)}))},a.showDetail=function(e){a.setState({person_data:{}});var t=e.name;a.setState({nowPerson:t});var r=a.state.dataPickervalue.format("YYYY"),i=a.state.dataPickervalue.format("MM"),o=a.state.dataPickervalue.format("DD"),l=Object(n.a)(a),c=new FormData;a.pid=e.pid,a.project=e.project,a.basic_quantity=e.basic_quantity,c.append("pid",e.pid),c.append("user",t),c.append("YY",r),c.append("MM",i),c.append("DD",o),G.a.post("/aidsp/workload/hoursinfo/",c).then((function(e){var t=e.data;l.setState({person_data:t})})).catch((function(e){console.log(e)})),a.setState({chartVisible:!0})},a.chartHideModal=function(){a.setState({chartVisible:!1,hoursShow:!0})},a.show_all_hours=function(e){if(a.state.hoursShow){a.setState({hourPersonsInfo:{}});var t=e.data._origin.hour;a.setState({nowHour:t});var r=a.state.dataPickervalue.format("YYYY"),i=a.state.dataPickervalue.format("MM"),o=a.state.dataPickervalue.format("DD"),l=Object(n.a)(a),c=new FormData;c.append("pid",a.pid),c.append("hour",t),c.append("YY",r),c.append("MM",i),c.append("DD",o),G.a.post("/aidsp/workload/hourpersonsinfo/",c).then((function(e){var t=e.data;l.setState({hourPersonsInfo:t})})).catch((function(e){console.log(e)})),a.setState({chartVisible:!0}),a.setState({hoursShow:!1})}},a.show_person_hours=function(e){a.setState({hoursShow:!0})},a.columns=[{title:"\u59d3\u540d",width:100,dataIndex:"name",sorter:function(e,t){return String(e.name?e.name:" ").localeCompare(String(t.name?t.name:" "),"zh")}},{title:"\u4efb\u52a1\u8be6\u60c5",dataIndex:"taskInfo",render:function(e,t){return t.taskInfo.map((function(e){return d.a.createElement("span",null,d.a.createElement("a",{href:"/aidsp/display/"+e.project_id,target:"_blank"},e.project),"\uff1a",d.a.createElement("a",{onClick:a.showDetail.bind(Object(n.a)(a),{name:t.name,pid:e.project_id,project:e.project,basic_quantity:e.basic_quantity})},e.workload),"\uff1b")}))}}],a.start_sdc=function(e){S.a.loading({content:"\u8bf7\u6c42\u4e2d...",key:"start_sdc",duration:0});var t=Object(n.a)(a);G.a.get("/aidsp/workload/scdenable").then((function(e){"\u5b9a\u65f6\u4efb\u52a1\u5f00\u542f\u5b8c\u6210"==e.data?(S.a.success({content:e.data,key:"start_sdc"}),t.setState({dataPickervalue:R()()}),t.componentDidMount()):S.a.info({content:e.data,key:"start_sdc"})})).catch((function(e){S.a.error({content:e.response.data,key:"start_sdc"})}))},a.picorpoi_onchange=function(e){a.setState({picorpoi:e.target.value})},a.real_time_job=function(e){S.a.loading({content:"\u8bf7\u6c42\u4e2d...",key:"real_time_job",duration:0});var t=Object(n.a)(a);G.a.get("/aidsp/workload/realtimejob").then((function(e){S.a.success({content:e.data,key:"real_time_job"}),t.setState({dataPickervalue:R()()}),t.componentDidMount()})).catch((function(e){S.a.error({content:e.response.data,key:"real_time_job"})}))},a}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=[R()().format("YYYY"),R()().format("MM"),R()().format("DD")];this.data_fetch(e),this.updated_time_fetch()}},{key:"render",value:function(){return d.a.createElement("div",null,d.a.createElement(P.a,{value:this.state.dataPickervalue,onChange:this.dataPickerChange}),d.a.createElement(k.a,{type:"primary",style:{marginLeft:"20px"},onClick:this.start_sdc},"\u542f\u52a8\u5b9a\u65f6\u4efb\u52a1"),d.a.createElement(k.a,{type:"primary",style:{marginLeft:"20px",marginRight:"20px"},onClick:this.real_time_job},"\u7acb\u5373\u66f4\u65b0\u67e5\u8be2"),d.a.createElement(ee,{code:!0},"\u6700\u540e\u66f4\u65b0\u65f6\u95f4:"),this.state.updated_time,d.a.createElement("br",null),d.a.createElement("br",null),d.a.createElement(g.a,{visible:this.state.chartVisible,onCancel:this.chartHideModal,footer:null},this.state.hoursShow?d.a.createElement("div",null,d.a.createElement(J.c,{forceFit:!0,height:500,padding:"50",data:this.state.person_data,scale:[{dataKey:"workload",alias:"\u56fe\u7247\u6570"},{dataKey:"pointsload",alias:"\u70b9\u6570"}]},d.a.createElement(J.g,null),d.a.createElement(J.a,null),d.a.createElement(J.b,{position:"hour*workload",onClick:this.show_all_hours}),d.a.createElement(J.e,{position:"hour*pointsload"}),d.a.createElement(J.f,{position:"hour*pointsload"})),d.a.createElement("div",null,d.a.createElement("p",{style:{float:"left"}},this.state.nowPerson),d.a.createElement("p",{style:{float:"right"}},"\t\t\t\u57fa\u7840\u91cf\uff1a"+this.basic_quantity)),d.a.createElement("br",null)):d.a.createElement("div",null,d.a.createElement(j.a.Group,{value:this.state.picorpoi,onChange:this.picorpoi_onchange,size:"small"},d.a.createElement(j.a.Button,{value:"pic"},"\u56fe\u7247\u5f20\u6570"),d.a.createElement(j.a.Button,{value:"poi"},"\u70b9\u6570")),d.a.createElement(J.c,{forceFit:!0,height:400,data:"pic"==this.state.picorpoi?this.state.hourPersonsInfo.picOrd:this.state.hourPersonsInfo.poiOrd,scale:[{dataKey:"workload",alias:"\u56fe\u7247\u6570"},{dataKey:"pointsload",alias:"\u70b9\u6570"}]},d.a.createElement(J.d,{type:"rect",direction:"LB"}),d.a.createElement(J.g,null),d.a.createElement(J.a,{dataKey:"assignee",label:{offset:12}}),d.a.createElement(J.b,{position:"pic"==this.state.picorpoi?"assignee*workload":"assignee*pointsload"})),d.a.createElement("div",null,d.a.createElement("p",{style:{float:"left"}},this.project+" "+this.state.nowHour),d.a.createElement("p",{style:{float:"right"}},"\t\t\t\u57fa\u7840\u91cf\uff1a"+this.basic_quantity)),d.a.createElement("br",null),d.a.createElement("br",null),d.a.createElement(k.a,{onClick:this.show_person_hours},"\u8fd4\u56de"))),d.a.createElement(x.a,{columns:this.columns,dataSource:this.state.data}))}}]),t}(d.a.Component)),oe=M.a.Header,le=M.a.Sider,ce=M.a.Content,se=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={main_show:re,collapsed:!1,silderValue:[1],current:window.location.pathname},a.toggle=function(){a.setState({collapsed:!a.state.collapsed})},a.menuSelect=function(e){"/aidsp/project"==e.key&&a.setState({main_show:ae}),"/aidsp/dataset"==e.key&&a.setState({main_show:ne}),"/aidsp/personal"==e.key&&a.setState({main_show:re}),"/aidsp/daily"==e.key&&a.setState({main_show:ie})},a.pagechange=function(e){"/aidsp/project"==e&&a.setState({main_show:ae}),"/aidsp/dataset"==e&&a.setState({main_show:ne}),"/aidsp/personal"==e&&a.setState({main_show:re}),"/aidsp/daily"==e&&a.setState({main_show:ie})},a.tit_ref=function(e){a.setState({main_show:a.state.main_show.split("#")[0]+e})},a.getMenuNodes=function(e){return e.map((function(e){return d.a.createElement(X,{title:d.a.createElement("a",{href:"#"+e.title},e.title),onTitleClick:a.tit_ref.bind(Object(n.a)(a),"#"+e.title.replace(/[.]/g,"").replace(/[ ]/g,"-"))},a.getMenuNodes(e.children))}))},a.ban_copy=function(e){var t=document.getElementById("myiframe").contentWindow.document;t.all?t.onselectstart=function(){return!1}:(t.onmousedown=function(){return!1},t.onmouseup=function(){return!0}),t.onselectstart=new Function("event.returnValue=false;")},a.showMD=function(e){a.setState({main_show:"/aidsp/static/"+e.key+".html",current:null}),setTimeout(a.ban_copy,1e3)},a.silderOnChange=function(e){document.getElementById("myiframe").contentWindow.document.body.style.zoom=e[0],isNaN(e)||a.setState({silderValue:e})},a.zoomOut=function(e){var t=a.state.silderValue;t[0]=t[0]-.01,a.setState({silderValue:t})},a.zoomIn=function(e){var t=a.state.silderValue;t[0]=t[0]+.01,a.setState({silderValue:t})},a.marks={.5:{onclick:a.aa,label:d.a.createElement(v.a,{type:"zoom-out",onClick:a.zoomOut})},2:{onclick:a.aa,label:d.a.createElement(v.a,{type:"zoom-in",onClick:a.zoomIn})}},a.handleClick=function(e){a.setState({current:e.key})},a}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.pagechange(window.location.pathname),A()({url:"/aidsp/doclist",method:"get"}).then((function(t){e.setState({meaulist:t})}))}},{key:"render",value:function(){var e=this;return d.a.createElement(z.a,null,d.a.createElement(M.a,{style:{minHeight:"100vh",height:"100%",width:"100%",border:"1px",position:"fixed",left:0,top:0}},d.a.createElement(le,{trigger:null,collapsible:!0,collapsed:this.state.collapsed},d.a.createElement("div",{className:"logo"},d.a.createElement("h1",{style:{color:"#ffffff",textAlign:"center",fontSize:"20px"}},this.state.collapsed?"":"\u6570\u636e\u96c6\u751f\u4ea7\u7ba1\u7406")),d.a.createElement(p.a,{theme:"dark",mode:"inline",selectedKeys:[this.state.current],onSelect:this.menuSelect,onClick:this.handleClick},d.a.createElement(p.a.Item,{key:"/aidsp/personal"},d.a.createElement(z.b,{to:"/aidsp/personal"},d.a.createElement(v.a,{type:"user"}),d.a.createElement("span",null,"\u4e2a\u4eba"))),d.a.createElement(p.a.Item,{key:"/aidsp/daily"},d.a.createElement(z.b,{to:"/aidsp/daily"},d.a.createElement(v.a,{type:"solution"}),d.a.createElement("span",null,"\u56e2\u961f\u65e5\u62a5"))),d.a.createElement(p.a.Item,{key:"/aidsp/project"},d.a.createElement(z.b,{to:"/aidsp/project"},d.a.createElement(v.a,{type:"appstore-o"}),d.a.createElement("span",null,"\u9879\u76ee"))),d.a.createElement(p.a.Item,{key:"/aidsp/dataset"},d.a.createElement(z.b,{to:"/aidsp/dataset"},d.a.createElement(v.a,{type:"appstore-o"}),d.a.createElement("span",null,"\u6570\u636e\u96c6"))),d.a.createElement(X,{title:d.a.createElement("span",null,d.a.createElement(v.a,{type:"file-text"}),d.a.createElement("span",null,"\u6587\u6863"))},this.state.meaulist&&Object.entries(this.state.meaulist).map((function(t){return d.a.createElement(X,{title:d.a.createElement("span",null,d.a.createElement("span",null,t[1].title)),key:t[1].title,mode:"horizontal",onTitleClick:e.showMD},">",e.getMenuNodes(t[1].children))}))))),d.a.createElement(M.a,null,d.a.createElement(oe,{style:{background:"#fff",padding:0}},d.a.createElement(v.a,{className:"trigger",type:this.state.collapsed?"menu-unfold":"menu-fold",onClick:this.toggle,style:{float:"left"}}),d.a.createElement("p",{style:{color:"red",fontSize:"30px"}},"\u8981\u4e48\u4e0d\u6807\uff0c\u8981\u6807\u5c31\u8981\u6807\u5bf9\uff0c \u7406\u89e3\u6e05\u695a\u89c4\u5219\u540e\u518d\u6807\uff0c \u6700\u65b0\u89c4\u5219\u6240\u6709\u4eba\u53ca\u65f6\u540c\u6b65\uff01\uff01")),d.a.createElement(ce,{style:{margin:"24px 16px",padding:24,background:"#fff",minHeight:280,overflowY:"auto"}},"function"==typeof this.state.main_show&&d.a.createElement(this.state.main_show,null),"function"!=typeof this.state.main_show&&d.a.createElement("div",{style:{height:"100%",width:"100%"},oncontextmenu:function(){return!1},onselectstart:function(){return!1}},d.a.createElement(Y.a,{span:6,style:{float:"right"}},d.a.createElement(q.a,{range:!0,min:.5,max:2,onChange:this.silderOnChange,step:.01,marks:this.marks,value:this.state.silderValue})),d.a.createElement("iframe",{id:"myiframe",src:this.state.main_show,height:"100%",width:"100%",frameborder:0}))))))}}]),t}(d.a.Component);h.a.render(d.a.createElement(se,null),document.getElementById("container"))},256:function(e,t,a){},257:function(e,t){}},[[249,1,2]]]);
//# sourceMappingURL=main.0fa10f69.chunk.js.map